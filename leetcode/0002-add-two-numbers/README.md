### Solution

 Bookkeeping / pointers / math.  No major tricks, you just have to keep track of things while doing the calculation.
